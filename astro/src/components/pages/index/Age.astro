---
import { differenceInYears } from "date-fns";

var birthday = new Date(2002, 10 - 1, 4);
var now = new Date();

var age = differenceInYears(now, birthday);
---

<style>
  #age {
    padding: 0.2em 0.4em;
    margin: 0;
    background-color: rgba(175, 184, 193, 0.2);
    border-radius: 6px;
    -webkit-box-decoration-break: clone;
    box-decoration-break: clone;
  }
</style>

<script>
  function updateAge() {
    var birthday = new Date(2002, 10 - 1, 4);
    var now = new Date();

    const msPerYear = 24 * 60 * 60 * 1000 * 365;
    let daysSince = (now.getTime() - birthday.getTime()) / msPerYear;
    let secondsSince = (now.getTime() - birthday.getTime()) / 1000;

    let years = Math.floor(daysSince);
    let seconds = Math.floor(secondsSince);
    let isBirthday =
      birthday.getMonth() == now.getMonth() &&
      birthday.getDate() == now.getDate();
    var outputString = `${seconds} seconds (${years} year${years > 1 ? "s" : ""}) old${isBirthday ? " ðŸŽ‚" : ""}`;

    document.getElementById("age")!.textContent = outputString;
  }
  updateAge();
  setInterval(updateAge, 1000);
</script>

<output id="age"><noscript>{age} years old</noscript></output>
